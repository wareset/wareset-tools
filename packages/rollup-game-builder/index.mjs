/* eslint-disable */
import*as e from"fs";import*as r from"path";import t from"jimp";import n from"adm-zip";import o from"@rollup/plugin-json";import s from"@rollup/plugin-inject";import i from"@rollup/plugin-replace";import a from"@rollup/plugin-commonjs";import l from"@rollup/plugin-node-resolve";import c from"rollup-plugin-polyfill-node";import m from"rollup-plugin-livereload";import p from"@wareset-tools/rollup-plugin-cssinjs-minify";import{optimize as u}from"svgo";import{minify as d}from"terser";import{transform as f}from"sucrase";import{transformAsync as g}from"@babel/core";const b="<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\" />\n    \x3c!-- <meta name=\"theme-color\" content=\"#222222\" /> --\x3e\n    <title>Game</title>\n    <style>\n      html,\n      body {\n        /* overflow: hidden; */\n        touch-action: none;\n        overscroll-behavior: contain;\n        background-color: #000;\n        color: #fff;\n        margin: 0;\n        font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue',\n          'Noto Sans', 'Liberation Sans', Arial, sans-serif, 'Apple Color Emoji',\n          'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n      }\n      html *,\n      html *::before,\n      html *::after {\n        font-family: inherit !important;\n      }\n      *,\n      *::before,\n      *::after {\n        box-sizing: border-box !important;\n\n        -webkit-user-drag: none !important;\n        -khtml-user-drag: none !important;\n        -moz-user-drag: none !important;\n        -ms-user-drag: none !important;\n\n        -webkit-touch-callout: none !important; /* iOS Safari */\n        -webkit-user-select: none !important; /* Safari */\n        -khtml-user-select: none !important; /* Konqueror HTML */\n        -moz-user-select: none !important; /* Old versions of Firefox */\n        -ms-user-select: none !important; /* Internet Explorer/Edge */\n        user-select: none !important;\n      }\n    </style>\n  </head>\n  <body>\n  </body>\n</html>\n";function y({sdkUrl:y="https://yandex.ru/games/sdk/v2",srcDir:h="src",appDir:v="app",zipDir:j="zip",staticDirName:x="static",injects:S={},plugins:w=[],globals:$={},indexHtmlFile:k=r.join(v,"_index.html"),scriptFileList:E=[]}={}){var F=JSON.stringify,R=!process.env.ROLLUP_WATCH,_=r.join(v,"_dev"),I=r.join(_,"scripts");e.mkdirSync(r.resolve(j),{recursive:!0}),e.mkdirSync(r.resolve(I),{recursive:!0});var O=(e.existsSync(k=r.resolve(k))?e.readFileSync(k,"utf8"):(e.writeFileSync(k,b),b)).replace(/\s*<!--[^]*?-->|\s*\/\*[^]*?\*\/|\s*\/\/[^\n]*/g,"").replace(/\s*\n/g,"\n");return e.readdirSync(r.resolve(h),{withFileTypes:!0}).filter((e=>e.isFile()&&/^[^_\W][^]*\.tsx?$/.test(e.name))).map(((b,k)=>{var L=b.name,N=L.match(/^\w+/)[0],D=r.join(_,`${N}.js`),M=R?null:m({watch:D,port:35729+k}),z=O.replace("</title>",`: ${N}</title>`),A=r.resolve(j,`${N}.zip`);return e.existsSync(A)&&e.rmSync(A),e.writeFileSync(r.resolve(v,`${N}.html`),z.replace(/\s*<\/body>/,E.map((t=>{t=r.resolve(t);var n=r.basename(t);return/\.js/.test(n)?(e.cpSync(t,r.resolve(I,n)),e.existsSync(t+".map")&&e.cpSync(t+".map",r.resolve(I,n+".map")),`\n    <script src=${F(`_dev/scripts/${n}`)}><\/script>`):""})).join("")+`\n    <script src=${F(`_dev/${N}.js`)} defer><\/script>\n  </body>`)),R&&(z=z.replace(/\s*<\/head>/,"\n    \x3c!-- Game SDK --\x3e"+(y?`\n    <script src=${F(y)}><\/script>`:"")+"\n  </head>").replace(/\s*<\/body>/,(E=E.map((t=>(t=r.resolve(t),/\.js/.test(t)?(!/\.min\.js/.test(t)&&e.existsSync(t.slice(0,-2)+"min.js")&&(t=t.slice(0,-2)+"min.js"),t):""))).filter(Boolean)).map((e=>`\n    <script src=${F(`${x}/scripts/${r.basename(e)}`)}><\/script>`)).join("")+`\n    <script src=${F(`${x}/build.js`)} defer><\/script>\n  </body>`)),{external:Object.keys($),input:r.join(h,L),output:{globals:$,sourcemap:!1,format:"iife",name:N,file:D},plugins:[o(),i({preventAssignment:!0,values:{"process.env.DEV":F(!R),"process.env.NODE_ENV":F(R?"production":"dev")}}),c(),l({browser:!0,preferBuiltins:!1,extensions:[".mjs",".js",".jsx",".mts",".ts",".tsx",".json"]}),a({sourceMap:!1}),{name:"logs-check",onLog(e,r){"MISSING_EXPORT"===r.code&&this.error(r)}},{name:"svg-custom",transform:(e,r)=>/\.svg$/.test(r)?(e=u(e).data,`export default ${F(encodeURIComponent(e))}`):null},{name:"img-custom",async transform(e,r){if(/\.(?:jpe?g|png|bmp|tiff|gif)$/.test(r)){var n=await t.read(r),o=await n.getBase64Async(n.getMIME());return`export default ${F(o)}`}return null}},{name:"sucrase-custom",transform(e,r){if(/\.[mc]?(?:jsx|tsx?)$/.test(r)){try{e=f(e,{transforms:["jsx","typescript"],production:!0,jsxRuntime:"classic"}).code}catch(t){throw console.error("sucrase-custom"),t}return{code:e}}return null}},p(),s({sourceMap:!1,REASE:["rease","*"],css:["rease","css"],"React.createElement":["rease","createElement"],"React.Fragment":["rease","RFragment"]}),Object.keys(S).length?s({sourceMap:!1,...S}):null,...w,M,{name:"babel-and-terser",async transform(e){if(R)try{return{code:e=(await g(e,{presets:[["@babel/preset-env",{corejs:3,loose:!0,bugfixes:!0,modules:!1,useBuiltIns:"entry",targets:"iOS 7"}]],plugins:["@babel/plugin-transform-runtime",["@babel/plugin-transform-block-scoping",{throwIfClosureRequired:!0}]]})).code}}catch(r){throw console.error("babel-custom"),r}},async renderChunk(e,r){if(R)try{return(await d(e,{sourceMap:!1,safari10:!0,mangle:!0,module:!0,toplevel:!0,compress:{drop_console:!0,keep_fnames:!1,keep_classnames:!1}})).code||(console.warn(`WARN: chunk "${r.name}" - terser return empty code`),e)}catch(t){throw console.error("terser-custom"),t}}},{name:"write-bundle",writeBundle(t){R&&t.name===N&&setTimeout((()=>{var t=new n,o=r.resolve(v,x);e.existsSync(o)&&t.addLocalFolder(o,x),E.forEach((e=>{t.addLocalFile(e,x+"/scripts")})),t.addFile("index.html",Buffer.from(z,"utf8")),t.addLocalFile(r.resolve(D),x,"build.js"),t.writeZip(A)}),500)}}],watch:{clearScreen:!1}}}))}export{y as default};

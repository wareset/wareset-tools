/* eslint-disable */
import*as e from"fs";import*as t from"os";import*as r from"path";import o from"puppeteer";var s={en:"английский",ar:"арабский",bg:"болгарский",hu:"венгерский",el:"греческий",da:"датский",id:"индонезийский",es:"испанский",it:"итальянский",zh:"китайский",ko:"корейский",lv:"латышский",lt:"литовский",de:"немецкий",nl:"нидерландский",nb:"норвежский",pl:"польский",pt:"португальский",ro:"румынский",ru:"русский",sk:"словацкий",sl:"словенский",tr:"турецкий",uk:"украинский",fi:"финский",fr:"французский",cs:"чешский",sv:"шведский",et:"эстонский",ja:"японский"},a=(()=>{var a,l,n,i,m=r.join(t.homedir(),".wareset_tools_deepl.cache.json"),u=[];console.log("DT cache: "+m);var c,f=async t=>{if(n&&n.res)try{var r=JSON.parse((await t.buffer()).toString()).result;if(!r)return;var o=r.source_lang,s=r.target_lang,a=r.translations;if(!o||!s||!a)return;if(o=o.toLowerCase(),s=s.toLowerCase(),n.from!==o||n.to!==s)return;console.log("DT: "+n.text),console.log(...a.map((e=>e.beams.map((e=>e.sentences[0].text)))));var l=a.map((e=>e.beams[0].sentences[0].text.replace(/^<P>/,"").replace(/<\/P>$/,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"))).join("\n");i&&(i[n.from]||(i[n.from]={}),i[n.from][n.to]||(i[n.from][n.to]={}),i[n.from][n.to][n.text]=l,e.writeFileSync(m,JSON.stringify(i,null,2))),n.res(l),n.res=null,await((e=100)=>new Promise((t=>setTimeout(t,e))))(n.timeout),n=null,g()}catch(u){}},p=()=>l&&(l.close(),l=a=null),g=async()=>{if(clearTimeout(c),!n)if(n=u.shift()){var t=n,r=t.from,s=t.to,h=t.text;if(!i&&(i={},e.existsSync(m)))try{i=JSON.parse(e.readFileSync(m,"utf8"))||{}}catch(w){}i[r]&&i[r][s]&&i[r][s][h]?(n.res(i[r][s][h]),n.res=null,n=null,g()):(a||(a=await(l=await o.launch({headless:!1})).newPage()).on("response",f),a.goto(`https://www.deepl.com/ru/translator#${r}/${s}/${encodeURI(h)}`))}else c=setTimeout(p,5e3)};return(e="",t="en",r="ru",o=999)=>{if(t===r)return Promise.resolve(e);if(!(t in s)||!(r in s))throw new Error(`wareset_tools_deepl: ${t} -> ${r}: - incorrect lang`);return new Promise((s=>{u.push({res:s,text:e,from:t,to:r,timeout:o}),g()}))}})(),l={ru:"русский",en:"английский",az:"азербайджанский",ay:"аймара",sq:"албанский",am:"амхарский",ar:"арабский",hy:"армянский",as:"ассамский",af:"африкаанс",bm:"бамбара",eu:"баскский",be:"белорусский",bn:"бенгальский",my:"бирманский",bg:"болгарский",bs:"боснийский",cy:"валлийский",hu:"венгерский",vi:"вьетнамский",gl:"галисийский",el:"греческий",ka:"грузинский",gn:"гуарани",gu:"гуджарати",da:"датский",zu:"зулу",iw:"иврит",ig:"игбо",yi:"идиш",id:"индонезийский",ga:"ирландский",is:"исландский",es:"испанский",it:"итальянский",yo:"йоруба",kk:"казахский",kn:"каннада",ca:"каталанский",qu:"кечуа",ky:"киргизский","zh-CN":"китайский",ko:"корейский",co:"корсиканский",xh:"коса",ht:"креольский",ku:"курдский",km:"кхмерский",lo:"лаосский",la:"латинский",lv:"латышский",ln:"лингала",lt:"литовский",lg:"луганда",lb:"люксембургский",mk:"македонский",mg:"малагасийский",ms:"малайский",ml:"малаялам",dv:"мальдивский",mt:"мальтийский",mi:"маори",mr:"маратхи",mn:"монгольский",de:"немецкий",ne:"непальский",nl:"нидерландский",no:"норвежский",or:"ория",om:"оромо",pa:"панджаби",fa:"персидский",pl:"польский",pt:"португальский",ps:"пушту",rw:"руанда",ro:"румынский",sm:"самоанский",sa:"санскрит",sr:"сербский",st:"сесото",si:"сингальский",sd:"синдхи",sk:"словацкий",sl:"словенский",so:"сомалийский",sw:"суахили",su:"сунданский",tg:"таджикский",th:"тайский",ta:"тамильский",tt:"татарский",te:"телугу",ti:"тигринья",ts:"тсонга",tr:"турецкий",tk:"туркменский",uz:"узбекский",ug:"уйгурский",uk:"украинский",ur:"урду",tl:"филиппинский",fi:"финский",fr:"французский",fy:"фризский",ha:"хауса",hi:"хинди",hr:"хорватский",ak:"чви",ny:"чева",cs:"чешский",sv:"шведский",sn:"шона",gd:"шотландский",ee:"эве",eo:"эсперанто",et:"эстонский",jw:"яванский",ja:"японский"},n=(()=>{var s,a,n,i,m=r.join(t.homedir(),".wareset_tools_google.cache.json"),u=[];console.log("GT cache: "+m);var c,f=async t=>{if(n&&n.res)try{var r=(await t.buffer()).toString().split("\n")[3],o=JSON.parse(JSON.parse(r)[0][2])[1],s=o[0][0][5],a=o[4],l=a[0],u=a[1],c=a[2];if(n.text!==l||n.from!==u||n.to!==c)return;var f=s.map((e=>e[0])).join("");console.log("GT:",f,c,u),i&&(i[n.from]||(i[n.from]={}),i[n.from][n.to]||(i[n.from][n.to]={}),i[n.from][n.to][n.text]=f,e.writeFileSync(m,JSON.stringify(i,null,2))),n.res(f),n.res=null,await((e=100)=>new Promise((t=>setTimeout(t,e))))(n.timeout),n=null,g()}catch(p){}},p=()=>a&&(a.close(),a=s=null),g=async()=>{if(clearTimeout(c),!n)if(n=u.shift()){var t=n,r=t.from,l=t.to,h=t.text;if(!i&&(i={},e.existsSync(m)))try{i=JSON.parse(e.readFileSync(m,"utf8"))||{}}catch(w){}i[r]&&i[r][l]&&i[r][l][h]?(n.res(i[r][l][h]),n.res=null,n=null,g()):(s||(s=await(a=await o.launch({headless:!1})).newPage()).on("response",f),s.goto(`https://translate.google.com/?sl=${r}&tl=${l}&text=${encodeURI(h)}&op=translate`))}else c=setTimeout(p,5e3)};return(e="",t="en",r="ru",o=2222)=>{if("zh"===t&&(t="zh-CN"),"zh"===r&&(r="zh-CN"),t===r)return Promise.resolve(e);if(!(t in l)||!(r in l))throw new Error(`wareset_tools_google: ${t} -> ${r}: - incorrect lang`);return new Promise((s=>{u.push({res:s,text:e,from:t,to:r,timeout:o}),g()}))}})();export{s as DEEPL_LANGS,l as GOOGLE_LANGS,a as deepl,n as google};

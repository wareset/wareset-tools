/* eslint-disable */
const e=require("rease");function i(e,i){return e==e?e===i:i!=i}function t(e,s,r){for(var n in s)(o=s[n])&&(o=Object.getPrototypeOf(o))===Object.prototype||!o?t(e[n],s[n],r[n]||(r[n]={})):i(r[n],s[n])||i(e[n],r[n]=s[n])||(e[n]=s[n]);var o}function s(e){e&&(t(this.rease.pixi,e,this.cache),this.rease.update())}function r(e){e&&(e.call(this,this.pixi),this.update())}function n(e,{props:i,$props$:n,$onDraw$:o,onCreate:a,onRender:d,onRenderCapture:h}){a&&a(e,e.pixi),d&&e.on("pixi-render",d),h&&e.on("pixi-render",h,void 0,!0),i&&t(e.pixi,i,{}),n&&e.watch(n,s,{rease:e,cache:{}}),o&&e.watch(o,r,e)}function o(i){var t=this.iam,s=this.props;if(t.pixi=i,t.onDestroy((()=>(t.pixi=void 0,i.destroy()))),!t.destroyed){var r=i.canvas,o=r.style;o.width=o.height="100%";var a=!1,d=e=>{a=!0,t._renderOptions&&(t.emitDeep("pixi-render",e),i.render(t._renderOptions))};t.update=()=>{a&&(a=!1,requestAnimationFrame(d))};var h=t.insert(e.createElement(e.RElement,{node:r}))[0];t.onDestroy(e.listen(r,"resize",(()=>{i.resize(r.clientWidth,r.clientHeight),t.update()}))),n(t,s),h.insert(s.children),a=!0,t.update()}}class PixiRenderer extends e.Rease{constructor(e){super(),this.await(e.autoDetectRenderer(e.options||{}),o,{iam:this,props:e})}update(){}}function a(){var e=this;e.assets[/Bundle$/.test(e.method)?"unloadBundle":"unload"](e.url||e.urls||e.bundleId||e.bundleIds)}function d(e){var i=this.iam,t=this.props;if(t.unset&&i.onDestroy(a,t),!i.destroyed){var s=t.children;i.insert("function"==typeof s?s.call(i,e):s)}}class PixiAssets extends e.Rease{constructor(e){super(),this.await(e.pixi[e.method](e.options||e.url||e.urls||e.bundleId||e.bundleIds||e.assets,e.onProgress||e.assets),d,{iam:this,props:e})}}class PixiScene extends e.Rease{constructor(e){super(),this.pixi=new e.pixi(e.options),this.onMove(c),c(this),n(this,e),this.insert(e.children),this.onDestroy(x)}update(){this.PixiRenderer&&this.PixiRenderer.update()}}function h(e){var i=e.PixiRenderer;i&&(i.PixiScene===e?i.PixiScene=i._renderOptions=void 0:e.update(),e.PixiRenderer=void 0)}var p=[PixiRenderer,PixiScene];function c(e){h(e);var i=e.findParentOrNext(p,PixiScene),t=i.parent,s=i.next,r=e.pixi;if(t instanceof PixiRenderer)t.PixiScene=e,t._renderOptions={container:r},e.PixiRenderer=t;else{var n=s&&s.pixi,o=n&&n.parent||t&&t.pixi;o?(n?o.addChildAt(r,o.getChildIndex(n)):o.addChild(r),e.PixiRenderer=(t||s).PixiRenderer):r.removeFromParent()}e.update()}function x(e){h(e),e.pixi.destroy()}function u(e){var i=e.PixiScene;if(i){var t=i.pixi,s=t.filters;if(s){var r=e.pixi;s===r?t.filters=[]:Array.isArray(s)&&(t.filters=s.filter((function(e){return this!==e}),r)),e.update()}e.PixiScene=void 0}}function l(e){u(e);var i=e.findParentOrNext(PixiScene,PixiFilter),t=i.parent,s=i.next,r=e.pixi,n=s&&s.pixi,o=t&&t.pixi;if(o){var a,d=o.filters;d=Array.isArray(d)?d.slice():d?[d]:[],n&&(a=d.indexOf(n))>-1?d.splice(a,0,r):d.push(r),o.filters=d,e.PixiScene=t,e.update()}}function f(e){u(e),e.pixi.destroy()}class PixiFilter extends e.Rease{constructor(e){super(),this.pixi=new e.pixi(e.options),this.onMove(l),l(this),n(this,e),this.onDestroy(f)}update(){this.PixiScene&&this.PixiScene.update()}}class PixiEvent extends e.Rease{constructor({$mode$:e,$once$:i,$type$:t,$handler$:s}){super(),this.onMove(this._move,this),this._move(),e&&this.watch(e,this._watchMode,this),this.watchAll([t,s,i],this._watch,this),this.onDestroy(this._destroy,this)}_watchMode(e){(this._mode=e)&&this.PixiScene&&(this.PixiScene.pixi.eventMode=e)}_watch([e,i,t]){this._off(),this._once=t,this._type=Array.isArray(e)?e.slice():[e],this._handler=i,this._on()}_off(){var e=this._type,i=this._handler,t=this.PixiScene;if(t&&e&&i)for(var s=t.pixi,r=e.length;r-- >0;)s.off(e[r],i,this)}_on(){var e=this._type,i=this._handler,t=this.PixiScene;if(t&&e&&i)for(var s=t.pixi,r=e.length;r-- >0;)s[this._once?"once":"on"](e[r],i,this)}_move(){var e=this.findParent(PixiScene);e!==this.PixiScene&&(this._off(),this.PixiScene=e,this._on(),this._mode&&(e.pixi.eventMode=this._mode))}_destroy(){this._off()}}exports.Assets=PixiAssets,exports.Event=PixiEvent,exports.Filter=PixiFilter,exports.Renderer=PixiRenderer,exports.Scene=PixiScene;
